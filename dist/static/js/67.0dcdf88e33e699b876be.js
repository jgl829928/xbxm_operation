webpackJsonp([67],{"2WiL":function(e,t){},"5ZUk":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),l=a("eMGh"),i=a("2A+d"),o=a("TIfe"),n={name:"addDevice",data:function(){return{checkEdit:"",dialogFormVisibleFir:!1,reqData:{equipmentCode:"",marketCode:"",equipmentModel:"",equipmentId:"",equipmentName:"",location:"",rankId:"",runStatus:"",firstId:""},categotyListFir:[],uploadUrl:i.a.imageUpload,categotyListSec:[],deviceStatus:[{value:0,label:"正常运行中"},{value:1,label:"故障维修中"},{value:2,label:"停止运行"},{value:3,label:"报废"}],rules:{marketCode:[{required:!0,message:"请选择商场",trigger:"change"}],firstId:[{required:!0,message:"请选择分类",trigger:"change"}],equipmentName:[{required:!0,message:"请输入设备名称",trigger:"blur"},{max:30,message:"最多输入30个字",trigger:"blur"}],equipmentModel:[{required:!0,message:"请输入设备型号",trigger:"blur"},{max:30,message:"最多输入30个字",trigger:"blur"}],runStatus:[{required:!0,message:"请选择运行状态",trigger:"blur"}],equipmentCode:[{required:!0,message:"请选择设备编号",trigger:"blur"},{max:50,message:"最多输入50个字",trigger:"blur"}],location:[{max:50,message:"最多输入50个字",trigger:"blur"}]},form:{parentId:"",rankName:""},fileList:[],secFormShow:!1,dialogRules:{rankName:[{required:!0,message:"请输入名称",trigger:"blur"},{max:20,message:"最多输入20个字",trigger:"blur"}],parentId:[{required:!0,message:"请输入名称",trigger:"blur"}]},marketSearch:[],role:!1}},components:{selectMarket:a("FTcF").a},created:function(){this.handleCategory("-1","categotyListFir")},computed:{gTicket:function(){return this.$store.state.gTicket}},methods:{handleRemove:function(e,t){this.fileList=t},handleList:function(e,t,a){e&&0==e.code&&e.data&&this.fileList.push(e.data)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+this.fileList.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},beforeLogoUpload:function(e){var t="image/jpeg"===e.type||"image/png",a=e.size/1024/1024<5;return t||this.$message.error("上传图片只能是 jpg、png、jpeg、bmp格式!"),a||this.$message.error("上传图片大小不能超过5MB!"),t&&a},showAdd:function(e){this.dialogFormVisibleFir=!0,this.secFormShow=0!=e},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=Object(o.d)(t.reqData,!0,["firstId","rankId"]);""==t.reqData.rankId&&(t.reqData.rankId=t.reqData.firstId);var r=[];0!=t.fileList.length&&t.fileList.forEach(function(e){var t={};t.name=e.name,t.url=e.url,-1==r.indexOf(e)&&r.push(t)});var l=s()({},a,{imageUrl:r,rankId:t.reqData.rankId});t.handleSave("post",l)})},handleSave:function(e,t){var a=this;this.$http({url:i.a.estateDevice,method:e,data:t}).then(function(e){e&&(a.$message.success(e.msg),a.$router.push({name:"device"}),a.$store.commit("delete_tabs",a.$route))})},firCategoryAdd:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$http.post(l.b.deviceCategory,s()({},t.form)).then(function(e){if(e){if(0!=e.code)return t.$message.error(e.msg);t.$message.success(e.msg),t.handleCategory("","categotyListFir"),t.changeSec(),t.dialogFormVisibleFir=!1}})})},reset:function(){var e=this;this.dialogFormVisibleFir=!1,this.$refs.form.resetFields(),this.$nextTick(function(){e.$refs.form.clearValidate()})},handleCategory:function(e,t){var a=this;this.$http({url:l.b.deviceCategory,method:"get",params:{parentId:e},showLoading:!1}).then(function(e){e&&0==e.code&&(e.data.length>0?(a[t]=e.data,"categotyListSec"==t&&(a.reqData.rankId=e.data[0].rankId)):(a[t]=[],a.reqData.rankId=""))})},changeSec:function(){""!=this.reqData.firstId?this.handleCategory(this.reqData.firstId,"categotyListSec"):(this.categotyListSec=[],this.reqData.rankId="")}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"g-add-device"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,rules:e.rules,"label-width":"110px","label-position":"right",inline:!0}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:11,xs:24}},[a("el-form-item",{attrs:{label:"所属商场",prop:"marketCode"}},[a("select-market",{attrs:{reqData:e.reqData}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"一级分类",prop:"firstId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.changeSec},model:{value:e.reqData.firstId,callback:function(t){e.$set(e.reqData,"firstId",t)},expression:"reqData.firstId"}},e._l(e.categotyListFir,function(e,t){return a("el-option",{key:t,attrs:{label:e.rankName,value:e.rankId}})}))],1),e._v(" "),a("el-button",{staticClass:"btn-handle",on:{click:function(t){e.showAdd(0)}}},[e._v("添加")])],1),e._v(" "),a("el-col",{staticClass:"u-margin-6",attrs:{span:12}},[a("el-form-item",{attrs:{label:"二级分类",prop:"rankId","label-width":"110px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.reqData.rankId,callback:function(t){e.$set(e.reqData,"rankId",t)},expression:"reqData.rankId"}},e._l(e.categotyListSec,function(e,t){return a("el-option",{key:t,attrs:{label:e.rankName,value:e.rankId}})}))],1),e._v(" "),a("el-button",{staticClass:"btn-handle",on:{click:function(t){e.showAdd(1)}}},[e._v("添加")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"设备名称",prop:"equipmentName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.equipmentName,callback:function(t){e.$set(e.reqData,"equipmentName","string"==typeof t?t.trim():t)},expression:"reqData.equipmentName"}})],1)],1),e._v(" "),a("el-col",{staticClass:"u-margin-6",attrs:{span:11}},[a("el-form-item",{attrs:{label:"运行状态",prop:"runStatus"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.runStatus,callback:function(t){e.$set(e.reqData,"runStatus",t)},expression:"reqData.runStatus"}},e._l(e.deviceStatus,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"设备型号",prop:"equipmentModel"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.equipmentModel,callback:function(t){e.$set(e.reqData,"equipmentModel","string"==typeof t?t.trim():t)},expression:"reqData.equipmentModel"}})],1)],1),e._v(" "),a("el-col",{staticClass:"u-margin-6",attrs:{span:11}},[a("el-form-item",{attrs:{label:"设备编号\n",prop:"equipmentCode"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.equipmentCode,callback:function(t){e.$set(e.reqData,"equipmentCode","string"==typeof t?t.trim():t)},expression:"reqData.equipmentCode"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"安装位置\n",prop:"location"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.location,callback:function(t){e.$set(e.reqData,"location","string"==typeof t?t.trim():t)},expression:"reqData.location"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"设备检验标识\n",prop:"skuCode"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.$http.defaults.baseURL+e.uploadUrl,"before-remove":e.beforeRemove,multiple:"",limit:10,"on-exceed":e.handleExceed,"on-success":e.handleList,"file-list":e.fileList,headers:{gTicket:e.gTicket},"on-remove":e.handleRemove,"before-upload":e.beforeLogoUpload}},[a("el-button",{staticClass:"btn-80 btn-upload",attrs:{size:"small",type:"primary"}},[e._v("浏览")])],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"u-button",attrs:{gutter:32}},[a("el-col",{attrs:{span:8,offset:16}},[a("el-button",{staticClass:"btn-save-big",attrs:{type:"primary"},on:{click:function(t){e.submitForm("reqData")}}},[e._v("保存")])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"s-dialog",attrs:{title:"分类-添加",visible:e.dialogFormVisibleFir},on:{"update:visible":function(t){e.dialogFormVisibleFir=t},close:e.reset}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.dialogRules,"label-width":"80px"}},[e.secFormShow?a("el-form-item",{attrs:{label:"一级分类",prop:"parentId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}},e._l(e.categotyListFir,function(e,t){return a("el-option",{key:t,attrs:{label:e.rankName,value:e.rankId}})}))],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"名称",prop:"rankName"}},[a("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.rankName,callback:function(t){e.$set(e.form,"rankName","string"==typeof t?t.trim():t)},expression:"form.rankName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-reset",on:{click:function(t){e.reset("form")}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:function(t){e.firCategoryAdd("form")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(n,c,!1,function(e){a("2WiL"),a("wZqt")},"data-v-16884882",null);t.default=u.exports},wZqt:function(e,t){}});
//# sourceMappingURL=67.0dcdf88e33e699b876be.js.map