webpackJsonp([17],{"JMT/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),r=a.n(n),l=a("2A+d"),o=(a("eMGh"),a("FTcF")),i=a("hm3b"),s=a("TIfe"),c={name:"expenditure",data:function(){return{pickerOptions:{disabledDate:function(e){var t=new Date;return e.getTime()>new Date(t.getFullYear(),t.getMonth(),0,0,0,0).getTime()}},dialogFormVisible:!1,reqData:{marketCode:"",assess:"",companyId:""},pageparams:{currentPage:1},itemList:[],companyList:[],fileList:[]}},components:{selectMarket:o.a,pagenation:i.a},created:function(){this.getData(),this.getCompanyList()},computed:{currentUser:function(){return this.$store.state.currentUser}},methods:{getOtherData:function(e){var t={marketCode:""};2===this.currentUser.affiliation?t.marketCode=this.currentUser.marketCode:t.marketCode=e,this.getCompanyList(t.marketCode)},code_change:function(e){this.reqData.companyId="",e&&this.getOtherData(e)},rightControl:function(e){return this.$store.getters.getPermission(e)},download_file:function(e,t){var a=this;this.$http({method:"get",url:"/business/download",params:{fileUrl:e},showLoading:!1,responseType:"arraybuffer"}).then(function(e){a.download(e.data,t)})},download:function(e,t){if(e){var a=new Blob([e]);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var n=window.URL.createObjectURL(new Blob([e])),r=document.createElement("a");r.style.display="none",r.href=n,r.setAttribute("download",t),document.body.appendChild(r),r.click()}}},checkConstrck:function(e){this.dialogFormVisible=!0,e.imgFinanceUrl?this.fileList=e.imgFinanceUrl:this.fileList=[]},getData:function(e){e=e||"";var t=r()({},this.reqData,{currentPage:e});Object(s.b)(e,t,l.a.finance,this)},handlePage:function(e){this.getData(e)},search:function(){this.getData(),this.getCompanyList()},getCompanyList:function(e){var t=this;this.$http({url:l.a.companyList,params:{marketCode:e},method:"get",showLoading:!1}).then(function(e){e&&0==e.code&&e.data&&(t.companyList=e.data)})},deleteData:function(e){var t=this;this.$confirm("此操作将永久删除该条, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.delete(l.a.finance+"/"+e,{params:{finance:e}}).then(function(e){e&&0==e.code&&(t.$message({type:"success",message:e.msg}),t.getData(t.pageparams.currentPage))})}).catch(function(){})}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p-expenditure-manage"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"商场",prop:"marketCode"}},[a("select-market",{attrs:{reqData:e.reqData},on:{change:e.code_change}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"物业公司",prop:"companyId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.companyId,callback:function(t){e.$set(e.reqData,"companyId",t)},expression:"reqData.companyId"}},e._l(e.companyList,function(e,t){return a("el-option",{key:t,attrs:{label:e.companyName,value:e.companyId}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"考核月份",prop:"assess"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM",type:"month","picker-options":e.pickerOptions,placeholder:"选择月"},model:{value:e.reqData.assess,callback:function(t){e.$set(e.reqData,"assess",t)},expression:"reqData.assess"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8,offset:16}},[a("div",{staticClass:"c-footer-btn"},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)])],1),e._v(" "),a("el-row",[a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.rightControl("expenditure_add"),expression:"rightControl('expenditure_add')"}],attrs:{span:8}},[a("router-link",{attrs:{to:{name:"addRecord"}}},[a("el-button",{staticClass:"btn-search btn-add",attrs:{type:"primary"}},[e._v("\n            添加记录\n          ")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",height:"500",stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"financeId","min-width":"160",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"companyName",label:"物业公司"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"year",label:"年份"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"month",label:"月份"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"day","min-width":"120",label:"合格/总天数"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"remittee",label:"收款方"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"paymentMethod",label:"付款方式"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contractValue",label:"合同金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"amount",label:"扣款金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"amountPaid",label:"实付金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"payment",label:"付款方"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"",label:"凭证"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{directives:[{name:"show",rawName:"v-show",value:e.rightControl("expenditure_info"),expression:"rightControl('expenditure_info')"}],staticClass:"u-check",on:{click:function(a){e.checkConstrck(t.row)}}},[e._v("查看")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"accountFor",label:"说明"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createName",label:"登记人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime","min-width":"130",label:"登记时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right","min-width":"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:{name:"editRecord",params:{financeId:t.row.financeId}},disabled:!e.rightControl("expenditure_edit")}},[a("el-button",{staticClass:"btn-handle",attrs:{type:"primary"}},[e._v("\n              修改\n          ")])],1),e._v(" "),a("el-button",{staticClass:"btn-handle",attrs:{type:"primary",disabled:!e.rightControl("expenditure_delete")},on:{click:function(a){e.deleteData(t.row.financeId)}}},[e._v("\n              删除\n          ")])]}}])})],1)],1),e._v(" "),a("pagenation",{attrs:{pageparams:e.pageparams,itemList:e.itemList},on:{handlePage:e.handlePage}}),e._v(" "),a("el-dialog",{staticClass:"s-dialog",attrs:{title:"凭证-查看",visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",[e._l(e.fileList,function(t,n){return a("el-row",{key:n},[a("el-col",{staticClass:"u-left",attrs:{span:19}},[a("span",[e._v(e._s(t.name))]),e._v(" "),0==e.fileList.length?a("span",[e._v("（无）")]):e._e()]),e._v(" "),a("el-col",{attrs:{span:5,xs:24}},[a("a",{on:{click:function(a){e.download_file(t.url,t.name)}}},[e._v("下载")])])],1)}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-80",on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关 闭")])],1)],2)])],1)},staticRenderFns:[]};var d=a("VU/8")(c,p,!1,function(e){a("oXBF"),a("JjX/")},"data-v-df49e194",null);t.default=d.exports},"JjX/":function(e,t){},oXBF:function(e,t){}});
//# sourceMappingURL=17.5c6b6b39fa2ccbeb7d76.js.map