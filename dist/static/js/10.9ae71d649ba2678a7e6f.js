webpackJsonp([10],{"5DTm":function(e,t){},"J/3j":function(e,t){},MSmS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),l=a("2A+d"),i=a("hm3b"),s=a("TIfe"),o=(a("NYxO"),{props:["dialogFormVisibleL","reqData","priceInfo","checkPost","expensePropertyList","titleName"],data:function(){return{checkCont:!0,show:!1,rules:{expenceName:[{required:!0,message:"请输入费用名称",trigger:"blur"},{max:20,message:"请限制输入在20字内",trigger:"blur"}],expenceBilling:[{required:!0,message:"请选择计价方式",trigger:"change"}],expenceProperty:[{required:!0,message:"请选择费用性质",trigger:"change"}],expenceIncome:[{required:!0,message:"请选择收入性质",trigger:"change"}],expencePeriod:[{required:!0,message:"请选择周期类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],expenceUnit:[{required:!0,message:"请选择单位",trigger:"change"}]},expenceNameList:[],expenceNameInput:2,periodList:[{label:"一次性",value:1},{label:"周期性",value:2}],incomeList:[{label:"收入",value:1},{label:"押金",value:2},{label:"代收",value:3}],expenseBillingList:[{label:"天面积计价",value:1},{label:"月面积计价",value:2},{label:"年面积计价",value:3},{label:"其他",value:4}],unitList:[{label:"元/年/平方米",value:1},{label:"元/月/平方米",value:2},{label:"元/日/平方米",value:3},{label:"元",value:4},{label:"元/年",value:5},{label:"元/月",value:6},{label:"元/日",value:7},{label:"其他",value:8}]}},watch:{priceInfo:function(e,t){this.reqData.billingS=e.billingS}},created:function(){this.getContractType()},methods:{checkValue:function(e){this.reqData.billingS[e+1]&&void 0!==this.reqData.billingS[e+1].beginAcreage&&(this.reqData.billingS[e+1].beginAcreage=this.reqData.billingS[e].endAcreage)},checkbillingS:function(e,t,a){var r=Number(t);Number(e.field.replace(/[^0-9]/gi,""));""==r&&a(new Error("请输入面积值")),r||a(new Error("请输入正确数值")),(r<0||r>1e5)&&a(new Error("面积值小于10万)")),/^\d+(\.\d{1,2})?$/.test(r)||a(new Error("最多为2位小数")),a()},checkendAcreage:function(e,t,a){var r=Number(t),n=Number(e.field.replace(/[^0-9]/gi,""));""==r&&a(new Error("请输入面积值")),Number(r)||a(new Error("请输入正确数值")),(r<0||r>1e5)&&a(new Error("面积值小于10万")),/^\d+(\.\d{1,2})?$/.test(r)||a(new Error("最多为2位小数")),Number(this.reqData.billingS[n].beginAcreage)>=r&&a(new Error("面积值必须递增")),Number(this.reqData.billingS[n+1])&&Number(this.reqData.billingS[n+1].beginAcreage)&&Number(this.reqData.billingS[n+1].beginAcreage)!=r&&a(new Error("面积值必须递增")),a()},validatePrice:function(e,t,a){var r=t.toString();""===t?a(new Error("价格不能为空")):t>=1e5?a(new Error("价格不大于100000")):/^\d+(\.\d{1,2})?$/.test(r)?a():a(new Error("输入2位小数"))},selectCostType:function(e){for(var t=this.$refs.reqData.fields,a=0;a<t.length;a++)if("expenceName"===t[a].prop){t[a].resetField(),t[a].clearValidate();break}1==e?this.checkCont=!1:2==e&&(this.checkCont=!0)},getContractType:function(){var e=this;this.$http.get(l.a.expencesContract).then(function(t){t&&0==t.code&&t.data&&(e.expenceNameList=t.data)})},resetForm:function(e){var t=this;this.$emit("changeStatus",!1),setTimeout(function(){t.$refs.reqData.clearValidate()},200)},removeDomain:function(e){var t=this.reqData.billingS.indexOf(e);-1!==t&&this.reqData.billingS.splice(t,1)},addDomain:function(){var e=this;if(this.reqData.billingS.push({billingCode:"",beginAcreage:"",endAcreage:"",price:""}),this.reqData.billingS.forEach(function(t,a){a<e.reqData.billingS.length-1&&e.reqData.billingS[a+1]&&void 0!==e.reqData.billingS[a+1].beginAcreage&&(e.reqData.billingS[a+1].beginAcreage=t.endAcreage)}),this.reqData.billingS.length>10)return this.$message.error("最多只能填写10个范围"),this.reqData.billingS.length=10},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.checkPost?t.submitFun("put",t.reqData.expenceCode):t.submitFun("post","")})},submitFun:function(e,t){var a=this;this.$http({url:l.a.expences+"/"+t,method:e,data:n()({},this.reqData)}).then(function(e){e&&(0==e.code?(a.$message.success(e.msg),a.$emit("changeStatus",!1),a.$emit("refresh"),a.$refs.reqData.resetFields(),setTimeout(function(){a.$refs.reqData.clearValidate()},10),a.reqData.billingS=[{billingCode:"",beginAcreage:"",endAcreage:"",price:""}]):a.$message.error(e.msg))})}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"l-dialog",attrs:{title:e.titleName,visible:e.dialogFormVisibleL,"close-on-click-modal":e.show,"close-on-press-escape":e.show,"show-close":e.show},on:{"update:visible":function(t){e.dialogFormVisibleL=t}}},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,rules:e.rules,"label-width":"110px",inline:!0,"label-position":"right"}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"费用性质",prop:"expenceProperty"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.selectCostType},model:{value:e.reqData.expenceProperty,callback:function(t){e.$set(e.reqData,"expenceProperty",t)},expression:"reqData.expenceProperty"}},e._l(e.expensePropertyList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:e.reqData.status,callback:function(t){e.$set(e.reqData,"status",t)},expression:"reqData.status"}},[a("el-radio",{attrs:{label:!1}},[e._v("停用")]),e._v(" "),a("el-radio",{attrs:{label:!0}},[e._v("启用")])],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[e.checkCont?a("el-form-item",{attrs:{label:"费用类型",prop:"expenceName"}},[a("el-input",{attrs:{clearable:"",placeholder:"费用类型"},model:{value:e.reqData.expenceName,callback:function(t){e.$set(e.reqData,"expenceName","string"==typeof t?t.trim():t)},expression:"reqData.expenceName"}})],1):a("el-form-item",{attrs:{label:"费用类型",prop:"expenceName"}},[a("el-select",{attrs:{placeholder:"费用类型",clearable:""},model:{value:e.reqData.expenceName,callback:function(t){e.$set(e.reqData,"expenceName",t)},expression:"reqData.expenceName"}},e._l(e.expenceNameList,function(e,t){return a("el-option",{key:t,attrs:{label:e.desc,value:e.desc}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"收入性质",prop:"expenceIncome"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.expenceIncome,callback:function(t){e.$set(e.reqData,"expenceIncome",t)},expression:"reqData.expenceIncome"}},e._l(e.incomeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"周期性质",prop:"expencePeriod"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.expencePeriod,callback:function(t){e.$set(e.reqData,"expencePeriod",t)},expression:"reqData.expencePeriod"}},e._l(e.periodList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"费用计价方式",prop:"expenceBilling"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.expenceBilling,callback:function(t){e.$set(e.reqData,"expenceBilling",t)},expression:"reqData.expenceBilling"}},e._l(e.expenseBillingList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"单位",prop:"expenceUnit"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.expenceUnit,callback:function(t){e.$set(e.reqData,"expenceUnit",t)},expression:"reqData.expenceUnit"}},e._l(e.unitList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{staticClass:"u-area",attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[e._v("\n       \t\t作用面积范围（计租面积）\n       \t")]),e._v(" "),a("el-col",{attrs:{span:9}},[e._v("\n       \t\t单价(元）\n       \t")])],1),e._v(" "),e._l(e.reqData.billingS,function(t,r){return a("el-row",{key:r,staticClass:"u-area-input",attrs:{gutter:32}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"billingS."+r+".beginAcreage",rules:[{validator:e.checkbillingS,trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"0.00",disabled:r>0},model:{value:t.beginAcreage,callback:function(a){e.$set(t,"beginAcreage","string"==typeof a?a.trim():a)},expression:"domain.beginAcreage"}})],1)],1),e._v(" "),a("el-col",{staticClass:"u-icon",attrs:{span:1.5}},[e._v("\n    ～\n\t")]),e._v(" "),a("el-col",{staticClass:"u-error-margin",attrs:{span:5}},[a("el-form-item",{attrs:{prop:"billingS."+r+".endAcreage",rules:[{validator:e.checkendAcreage,trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"0.00"},on:{blur:function(t){e.checkValue(r)}},model:{value:t.endAcreage,callback:function(a){e.$set(t,"endAcreage","string"==typeof a?a.trim():a)},expression:"domain.endAcreage"}})],1)],1),e._v(" "),a("el-col",{staticClass:"u-price",attrs:{span:6.5}},[a("el-form-item",{attrs:{prop:"billingS."+r+".price",rules:[{validator:e.validatePrice,trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"0.00-99999.99"},model:{value:t.price,callback:function(a){e.$set(t,"price","string"==typeof a?a.trim():a)},expression:"domain.price"}})],1)],1),e._v(" "),a("el-col",{staticClass:"u-domain",attrs:{span:2}},[0==r?a("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addDomain}}):e._e(),e._v(" "),0!=r?a("i",{staticClass:"el-icon-remove-outline",on:{click:function(a){a.preventDefault(),e.removeDomain(t)}}}):e._e()])],1)})],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:function(t){e.submitForm("reqData")}}},[e._v("保存")]),e._v(" "),a("el-button",{staticClass:"btn-reset",attrs:{type:"primary"},on:{click:function(t){e.resetForm("reqData")}}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var p=a("VU/8")(o,c,!1,function(e){a("J/3j")},"data-v-65714340",null).exports,u={name:"costSetting",data:function(){return{reqData:{expenceName:"",expenceCode:"",expenceBilling:"",expenceProperty:"",expenceIncome:"",expencePeriod:"",status:"",expenceUnit:"",billingS:[{billingCode:"",beginAcreage:"0.01",endAcreage:"",price:""}]},dialogFormVisibleS:!1,dialogFormVisibleL:!1,reqpageData:{expenceCode:"",expenceProperty:"",orderStage:"",pageSize:"20",searchCount:""},expenceIncomeMap:{1:{text:"收入"},2:{text:"押金"},3:{text:"代收"}},expenceBillingMap:{1:{text:"天面积计价"},2:{text:"月面积计价"},3:{text:"年面积计价"},4:{text:"其他"}},expensePropertyList:[{label:"合同费用",value:1},{label:"非合同费用",value:2}],pageparams:{},itemList:[],form:{name:""},formLabelWidth:"120px",priceInfo:{},checkPost:"",titleName:""}},components:{pagenation:i.a,addCost:p},created:function(){this.getData()},methods:{rightControl:function(e){return this.$store.getters.getPermission(e)},checkOne:function(e){1==e?""!=this.reqpageData.expenceCode&&""==this.reqpageData.expenceProperty&&(this.$notify({title:"警告",message:"搜索条件只能选择一个",type:"warning"}),this.reqpageData.expenceProperty=""):2==e&&""==this.reqpageData.expenceCode&&""!=this.reqpageData.expenceProperty&&(this.$notify({title:"警告",message:"搜索条件只能选择一个",type:"warning"}),this.reqpageData.expenceCode="")},addcontract_type:function(e){this.titleName="添加费用",this.checkPost=!1,this.dialogFormVisibleL=!0},checkInfo:function(e){this.dialogFormVisibleS=!0,this.getPrice(e.expenceCode)},getPrice:function(e){var t=this;this.$http.get(l.a.expences+"/"+e+"/price").then(function(e){e&&0==e.code&&(t.priceInfo=e.data)})},search1:function(){""!=this.reqpageData.expenceCode&&""!=this.reqpageData.expenceProperty?this.$notify({title:"警告",message:"搜索条件只能选择一个",type:"warning"}):this.getData()},search:function(){""!=this.reqpageData.expenceCode&&""!=this.reqpageData.expenceProperty?this.$notify({title:"警告",message:"搜索条件只能选择一个",type:"warning"}):this.getData(this.pageparams.currentPage)},indexMethod:function(e){return e+20*(this.pageparams.currentPage-1)+1},editcontract_type:function(e){this.titleName="修改费用",this.checkPost=!0,this.dialogFormVisibleL=!0,this.reqData=Object(s.d)(e,!0,""),this.$set(this.reqData,"billingS",[{billingCode:"",beginAcreage:"",endAcreage:"",price:""}]),this.getPrice(e.expenceCode)},getData:function(e){var t,a=e||"";""!=this.reqpageData.expenceCode?t=Object(s.d)(this.reqpageData,!0,["expenceProperty"]):""!=this.reqpageData.expenceProperty&&(t=Object(s.d)(this.reqpageData,!0,["expenceCode"]));var r=n()({currentPage:a},t);Object(s.b)(a,r,l.a.expences,this)},handlePage:function(e){this.getData(e)},getStatus:function(e){this.dialogFormVisibleL=e;this.reqData=Object(s.d)({expenceName:"",expenceCode:"",expenceBilling:"",expenceProperty:"",expenceIncome:"",expencePeriod:"",status:"",expenceUnit:"",billingS:[{billingCode:"",beginAcreage:"",endAcreage:"",price:""}]},!0,[""])}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"g-cost-setting"},[a("el-form",{ref:"reqpageData",staticClass:"c-search-form",attrs:{model:e.reqpageData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"费用性质",prop:"expenceProperty"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:function(t){e.checkOne(1)}},model:{value:e.reqpageData.expenceProperty,callback:function(t){e.$set(e.reqpageData,"expenceProperty","string"==typeof t?t.trim():t)},expression:"reqpageData.expenceProperty"}},e._l(e.expensePropertyList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"费用编号",prop:"expenceCode"}},[a("el-input",{attrs:{clearable:""},on:{focus:function(t){e.checkOne(2)}},model:{value:e.reqpageData.expenceCode,callback:function(t){e.$set(e.reqpageData,"expenceCode","string"==typeof t?t.trim():t)},expression:"reqpageData.expenceCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search1}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.rightControl("costSetting_add"),expression:"rightControl('costSetting_add')"}],attrs:{span:8}},[a("el-button",{staticClass:"btn-search btn-add",attrs:{type:"primary"},on:{click:function(t){e.addcontract_type()}}},[e._v("添加")])],1)],1)],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",height:"500",stripe:""}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expenceName",label:"费用类型"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expenceCode",label:"费用编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketName",label:"所在商场"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expencePeriod",label:"周期性质"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1==t.row.expencePeriod?"一次性":"周期性")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expenceIncome",label:"收入性质"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.expenceIncomeMap[t.row.expenceIncome].text)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expenceProperty",label:"费用性质"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1==t.row.expenceProperty?"合同费用":"非合同费用")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"expenceBilling",label:"费用计价方式","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.expenceBillingMap[t.row.expenceBilling].text)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"u-color",on:{click:function(a){e.checkInfo(t.row)}}},[e._v("查看")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1==t.row.status?"启用":"禁用")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn-handle",attrs:{type:"primary",disabled:!e.rightControl("costSetting_edit")},on:{click:function(a){e.editcontract_type(t.row)}}},[e._v("\n                修改\n            ")])]}}])})],1),e._v(" "),a("el-dialog",{staticClass:"s-dialog",attrs:{title:"查看单价",visible:e.dialogFormVisibleS},on:{"update:visible":function(t){e.dialogFormVisibleS=t}}},[a("span",{staticClass:"u-unit"},[e._v("单位")]),a("span",{staticClass:"u-value"},[e._v(e._s(e.priceInfo.unitName))]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.priceInfo.billingS,align:"center",stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"billingTypeName",label:"作用面积范围(计租面积)","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.beginAcreage)+"～"+e._s(t.row.endAcreage)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"price",label:"单价（元）"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-close",attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisibleS=!1}}},[e._v("关闭")])],1)],1)],1),e._v(" "),a("add-cost",{attrs:{dialogFormVisibleL:e.dialogFormVisibleL,priceInfo:e.priceInfo,checkPost:e.checkPost,expensePropertyList:e.expensePropertyList,titleName:e.titleName,reqData:e.reqData},on:{changeStatus:e.getStatus,refresh:e.search}}),e._v(" "),a("pagenation",{attrs:{pageparams:e.pageparams,itemList:e.itemList},on:{handlePage:e.handlePage}})],1)},staticRenderFns:[]};var d=a("VU/8")(u,g,!1,function(e){a("5DTm"),a("Xco3")},"data-v-7a6a5f09",null);t.default=d.exports},Xco3:function(e,t){}});
//# sourceMappingURL=10.9ae71d649ba2678a7e6f.js.map