webpackJsonp([43],{"58j1":function(e,t){},"9nP/":function(e,t){},Yqgb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),n=a("hm3b"),l=a("TIfe"),s=a("2A+d"),o=a("eMGh"),c={name:"districtMag",data:function(){return{dialogFormVisible:!1,pageparams:{currentPage:1},reqData:{areaCode:"",marketName:""},itemList:[],marketPartitionTypeMap:{1:{value:"品类划分"},2:{value:"区域划分"}},form:{name:""},reqDiaData:{marketCode:"",marketPartitionType:"",marketPartitionNames:[{name:""}]},reqDiaDataCopy:{marketCode:"",marketPartitionType:"",marketPartitionNames:[{name:""}]},formLabelWidth:"120px",areaList:[],setHeight:{height:0},name:"",marketList:[]}},components:{pagenation:n.a},created:function(){this.getArea(null,"areaList",o.b.areaAll),this.getData()},methods:{rightControl:function(e){return this.$store.getters.getPermission(e)},reset:function(){var e=this;this.dialogFormVisible=!1,this.$refs.reqDiaData.resetFields(),this.$nextTick(function(){e.$refs.reqDiaData.clearValidate()}),this.reqDiaData=Object(l.d)(this.reqDiaDataCopy,!0,[""])},addcontract_type:function(e){var t=this;if(this.dialogFormVisible=!0,this.reqDiaData.marketCode=e.marketCode,this.name=e.marketName,this.reqDiaData.marketPartitionType=e.marketPartitionType,e.marketPartitionName)if(e.marketPartitionName.search(";")>-1){var a=[];e.marketPartitionName.split(";").forEach(function(e,r){var i={};i.name=e,a.push(i),t.reqDiaData.marketPartitionNames=a}),window.localStorage.setItem("marketPartitionNameLen",a.length)}else{var r=[],i={};i.name=e.marketPartitionName,r.push(i),this.reqDiaData.marketPartitionNames=r,window.localStorage.setItem("marketPartitionNameLen",1)}},saveChange:function(){var e=this,t=Object(l.d)(this.reqDiaData,"true","marketPartitionNames"),a=this.reqDiaData.marketPartitionNames.map(function(e){return e.name});this.$http.post(s.a.partition,i()({},t,{marketPartitionNames:a})).then(function(t){t&&(0==t.code?(e.$message.success(t.msg),e.dialogFormVisible=!1,e.getData()):e.$message.error(t.msg))})},search:function(){this.getData()},indexMethod:function(e){return e+20*(this.pageparams.currentPage-1)+1},getData:function(e){e=e||this.pageparams.currentPage||"";var t=i()({},this.reqData,{currentPage:e});Object(l.b)(e,t,s.a.partition,this)},handlePage:function(e){this.getData(e)},getArea:function(e,t,a){var r=this;this.$http({url:a,method:"get",params:{areaCode:e}}).then(function(e){e&&0==e.code&&(r[t]=e.data)})},changeMarket:function(e){this.reqData.marketName="",e?this.getArea(e,"marketList",o.b.districtSearch):this.marketList=[]},addStoreName:function(){if(this.reqDiaData.marketPartitionNames.push({name:""}),this.reqDiaData.marketPartitionNames.length>10)return this.$message.error("最多只能填写10个范围"),this.reqDiaData.marketPartitionNames.length=10},deleteStoreName:function(e){this.reqDiaData.marketPartitionNames.splice(e,1)}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"g-district-manage"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"areaCode",label:"所在省市"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.changeMarket(e.reqData.areaCode)}},model:{value:e.reqData.areaCode,callback:function(t){e.$set(e.reqData,"areaCode",t)},expression:"reqData.areaCode"}},e._l(e.areaList,function(e,t){return a("el-option",{key:t,attrs:{label:e.areaName,value:e.areaCode}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商场名称",prop:"marketName"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.reqData.marketName,callback:function(t){e.$set(e.reqData,"marketName",t)},expression:"reqData.marketName"}},e._l(e.marketList,function(e,t){return a("el-option",{key:t,attrs:{label:e.marketName,value:e.marketName}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"m-dialog",attrs:{title:"区域-修改",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.reset}},[a("el-form",{ref:"reqDiaData",staticClass:"c-search-form",attrs:{model:e.reqDiaData,"label-width":"",inline:!0,"label-position":"right"}},[a("el-row",{staticClass:"u-line"},[a("el-col",{attrs:{span:8}},[a("span",[e._v("商场名称：")]),e._v(" "),a("span",{staticClass:"u-color"},[e._v(e._s(e.name))])]),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"划分规则","label-width":"110px",prop:"marketPartitionType",rules:{required:!0,message:"划分规则不能为空",trigger:"blur"}}},[a("el-radio-group",{model:{value:e.reqDiaData.marketPartitionType,callback:function(t){e.$set(e.reqDiaData,"marketPartitionType",t)},expression:"reqDiaData.marketPartitionType"}},[a("el-radio",{attrs:{label:1}},[e._v("品类划分")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("区域划分")])],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"c-table-wrap table-wrap"},[a("el-button",{staticClass:"table-add-btn u-add",attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.addStoreName()}}}),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.reqDiaData.marketPartitionNames,align:"center",stripe:""}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"",label:"区域名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{key:t.$index,attrs:{prop:"marketPartitionNames."+t.$index+".name",rules:[{required:!0,message:"区域名不能为空",trigger:"blur"},{max:20,message:"字数限制为20字",trigger:"blur"}]}},[a("el-input",{attrs:{clearable:""},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name","string"==typeof a?a.trim():a)},expression:"scope.row.name"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"","min-width":"20"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.$index?a("el-button",{staticClass:"u-del",attrs:{type:"text",icon:"el-icon-remove-outline"},on:{click:function(a){e.deleteStoreName(t.$index)}}}):e._e()]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:e.saveChange}},[e._v("保存")]),e._v(" "),a("el-button",{staticClass:"btn-reset",attrs:{type:"primary"},on:{click:e.reset}},[e._v("取消")])],1)],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",stripe:"",height:"500"}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketName",label:"商场名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketCode",label:"商场编码",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"areaCodeName",label:"所在省市"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(1==t.row.status?"启用":"禁用")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"responsibleUserName",label:"负责人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contactTel",label:"负责人联系电话","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"address",label:"商场地址"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createUserName",label:"登记人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime",label:"登记时间","min-width":"165"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketPartitionType",label:"规划规则"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.marketPartitionType?e.marketPartitionTypeMap[t.row.marketPartitionType].value:"--")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketPartitionName",label:"区域名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn-handle",attrs:{type:"primary",disabled:!e.rightControl("districtMag_edit")},on:{click:function(a){e.addcontract_type(t.row)}}},[e._v("\n            区域修改\n          ")])]}}])})],1)],1),e._v(" "),a("pagenation",{attrs:{pageparams:e.pageparams,itemList:e.itemList},on:{handlePage:e.handlePage}})],1)},staticRenderFns:[]};var p=a("VU/8")(c,m,!1,function(e){a("9nP/"),a("58j1")},"data-v-5b9aa084",null);t.default=p.exports}});
//# sourceMappingURL=43.394676d966b780df5201.js.map