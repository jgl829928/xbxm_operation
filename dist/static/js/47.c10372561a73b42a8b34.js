webpackJsonp([47],{CHsM:function(e,t){},TeZt:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Gu7T"),l=r.n(a),i=r("//Fk"),o=r.n(i),n=r("hVDB"),s={name:"addRental",data:function(){return{time:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-6048e5),e.$emit("pick",[r,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-2592e6),e.$emit("pick",[r,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-7776e6),e.$emit("pick",[r,t])}}]},rules:{marketCode:[{required:!0,message:"请选择所属商场",trigger:"change"}],billboardCode:[{required:!0,message:"请选择广告位",trigger:"change"}],merchantType:[{required:!0,message:"请选择商户类型",trigger:"change"}],merchantCode:[{required:!0,message:"请选择投放商户",trigger:"change"}],merchantName:[{required:!0,message:"请输入商户名称",trigger:"blur"}],timeSelect:[{required:!0,message:"请选择上架时间",trigger:"change"}],signPrice:[{required:!0,message:"请输入签约价格",trigger:"blur"},{trigger:"blur",pattern:/^\d+(?:\.\d{1,2})?$/,message:"请输入大于等于零的数字，最多保留两位小数"}]},storeNameOption:[],advertiseList:[],merchantList:[],merchantTypeList:[{desc:"外部商户",value:1},{desc:"内部商户",value:2}],ruleForm:{marketCode:"",billboardCode:"",merchantCode:"",merchantName:"",merchantType:2,timeSelect:"",beginTime:"",endTime:"",duration:"",signPrice:""},storeOptionDisabled:!1}},methods:{getOptionData:function(){var e=this,t=this.$http.get(n.a.allStore);o.a.all([t]).then(function(t){if(0===t[0].code){e.storeNameOption=[],e.storeNameOption=[].concat(l()(t[0].data));var r=e.$store.getters.currentUser.marketCode;console.log("addRental",r),r&&(e.ruleForm.marketCode=r,e.storeOptionDisabled=!0,e.getAdvertiseOptionData())}})},getAdvertiseOptionData:function(){var e=this;if(""!==this.ruleForm.marketCode){var t=this.$http.get(n.a.selectAdvertiseOption+"?marketCode="+this.ruleForm.marketCode+"&bdStatus="),r=this.$http.get(n.a.merchants+"?marketCode="+this.ruleForm.marketCode);o.a.all([t,r]).then(function(t){0===t[0].code&&(e.advertiseList=[],e.advertiseList=[].concat(l()(t[0].data))),0===t[1].code&&(e.merchantList=[],e.merchantList=[].concat(l()(t[1].data)))})}else this.advertiseList=[],this.merchantList=[]},timeSelected:function(e){if(null===e)this.ruleForm.duration="",this.ruleForm.beginTime="",this.ruleForm.endTime="";else{var t=[].concat(l()(e));this.ruleForm.beginTime=t[0],this.ruleForm.endTime=t[1];var r=new Date(t[0]),a=new Date(t[1]);this.ruleForm.duration=(a-r)/1e3/86400+1+""}},merchantTypeSwitch:function(e){1===e?this.ruleForm.merchantCode="":this.ruleForm.merchantName=""},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$http.post(n.a.advertiseRentalList,t.ruleForm).then(function(e){0===e.code?(t.$message.success(e.msg),t.$store.commit("delete_tabs",t.$route),t.$router.push("/operation/rental")):t.$message.error(e.msg)})})},resetForm:function(e){this.$refs[e].resetFields()}},beforeMount:function(){this.getOptionData()}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contract-receipts add-rental"},[r("div",{staticClass:"main-title"},[e._v("\n    出租登记\n  ")]),e._v(" "),r("br"),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"c-search-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"102px",inline:!0,"label-position":"right"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商场",prop:"marketCode"}},[r("el-select",{attrs:{disabled:e.storeOptionDisabled,clearable:"",placeholder:"请选择"},on:{change:e.getAdvertiseOptionData},model:{value:e.ruleForm.marketCode,callback:function(t){e.$set(e.ruleForm,"marketCode","string"==typeof t?t.trim():t)},expression:"ruleForm.marketCode"}},e._l(e.storeNameOption,function(e,t){return r("el-option",{key:t,attrs:{label:e.marketName,value:e.marketCode}})}))],1)],1),e._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[r("el-form-item",{attrs:{label:"广告位",prop:"billboardCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.billboardCode,callback:function(t){e.$set(e.ruleForm,"billboardCode","string"==typeof t?t.trim():t)},expression:"ruleForm.billboardCode"}},e._l(e.advertiseList,function(e,t){return r("el-option",{key:t,attrs:{label:e.billboardName,value:e.billboardCode}})}))],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"商户类型",prop:"merchantType"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.merchantTypeSwitch},model:{value:e.ruleForm.merchantType,callback:function(t){e.$set(e.ruleForm,"merchantType","string"==typeof t?t.trim():t)},expression:"ruleForm.merchantType"}},e._l(e.merchantTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.desc,value:e.value}})}))],1)],1),e._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[2===e.ruleForm.merchantType?r("el-form-item",{attrs:{label:"投放商户",prop:"merchantCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.merchantCode,callback:function(t){e.$set(e.ruleForm,"merchantCode","string"==typeof t?t.trim():t)},expression:"ruleForm.merchantCode"}},e._l(e.merchantList,function(e,t){return r("el-option",{key:t,attrs:{label:e.merchantName,value:e.merchantCode}})}))],1):r("el-form-item",{attrs:{label:"投放商户",prop:"merchantName"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.merchantName,callback:function(t){e.$set(e.ruleForm,"merchantName","string"==typeof t?t.trim():t)},expression:"ruleForm.merchantName"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[r("el-form-item",{attrs:{label:"投放时间",prop:"timeSelect"}},[r("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},on:{change:e.timeSelected},model:{value:e.ruleForm.timeSelect,callback:function(t){e.$set(e.ruleForm,"timeSelect","string"==typeof t?t.trim():t)},expression:"ruleForm.timeSelect"}})],1)],1),e._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[r("el-form-item",{attrs:{label:"时长"}},[r("span",{staticClass:"duration-day"},[e._v(e._s(e.ruleForm.duration||0)+"  天")])])],1)],1),e._v(" "),r("el-row",[r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[r("el-form-item",{attrs:{label:"签约价格",prop:"signPrice"}},[r("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.signPrice,callback:function(t){e.$set(e.ruleForm,"signPrice","string"==typeof t?t.trim():t)},expression:"ruleForm.signPrice"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"save-div"},[r("el-button",{staticClass:"btn-save-big",attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var m=r("VU/8")(s,c,!1,function(e){r("cJ9L"),r("CHsM")},"data-v-51f0420c",null);t.default=m.exports},cJ9L:function(e,t){}});
//# sourceMappingURL=47.c10372561a73b42a8b34.js.map