webpackJsonp([63],{Ufoo:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("UpQb"),o=a("hm3b"),l=a("FTcF"),s={name:"boothMain",components:{Pagenation:o.a,selectMarket:l.a},computed:{currentUser:function(){return this.$store.state.currentUser}},data:function(){return{centerDialogVisible:!1,title:"",pageDefault:{totalRecords:0,currentPage:1,pageSize:20},formType:"add",affiliation:!0,boothCode:0,floor:[],area:[],marketInfo:{},marketList:[],pageParams:{boothNumber:"",boothTypeCode:"",floor:"",managerName:"",boothStatus:"",marketCode:"",currentPage:1},ruleForm:{boothNumber:"",boothPrice:"",boothTypeCode:"",calculateArea:"",floor:"",area:"",marketCode:"",notes:"",units:1,usableArea:""},rules:{boothNumber:[{required:!0,message:"请输入摊位号",trigger:"change"},{pattern:/^[0-9a-zA-Z-]{1,}$/,message:"摊位号只能输入字母数字中划线",trigger:"blur"}],floor:[{required:!0,message:"请选择楼层",trigger:"change"}],marketCode:[{required:!0,message:"请选择商场",trigger:"change"}],calculateArea:[{required:!0,message:"请输入计租面积",trigger:"change"},{pattern:/^(\d{1,5}|\d{1,5}\.\d{1,2})$/,message:"计租面积只能小于10万",trigger:"blur"}],boothPrice:[{message:"请输入摊位单价",trigger:"change",required:!0},{pattern:/^(\d{1,5}|\d{1,5}\.\d{1,2})$/,message:"单价只能小于10万",trigger:"blur"}],usableArea:[{required:!0,message:"请输入实际面积",trigger:"change"},{pattern:/^(\d{1,5}|\d{1,5}\.\d{1,2})$/,message:"实际面积只能小于10万",trigger:"blur"}]},itemList:[],statusList:[{label:"未出租",value:1},{label:"签约待审核",value:2},{label:"已出租",value:3},{label:"交款期",value:4},{label:"欠款待缴费",value:5},{label:"合同到期",value:6},{label:"已预定",value:7}],boothPriceList:[{label:"元/年/平米",value:1},{label:"元/月/平米",value:2},{label:"元/日/平米",value:3},{label:"元",value:4},{label:"元/年",value:5},{label:"元/月",value:6},{label:"元/日",value:7},{label:"其他",value:8}],typeList:[]}},watch:{pageParams:{handler:function(e){var t=this;t.affiliation||this.$http.get(r.a.marketFloor,{params:{marketCode:e.marketCode}}).then(function(e){0===e.code&&(t.floor=e.data.floors.split(","),t.area=e.data.marketPartitionNames)})},deep:!0}},mounted:function(){var e=this;this.$http.get(r.a.marketsName,{params:{areaCode:""}}).then(function(t){0===t.code&&(e.marketList=t.data)});var t=this.$route.params.marketName||"";t?setTimeout(function(){e.marketList.forEach(function(a){a.marketName==t&&(e.pageParams.marketCode=a.marketCode,e.$http.get(r.a.boothMaintains,{params:e.pageParams}).then(function(t){0===t.code&&(e.pageDefault.totalRecords=t.page.totalRecords,e.itemList=t.data)}))})},500):this.getPageList(1),this.marketInfo=this.currentUser,1==this.currentUser.affiliation?this.affiliation=!1:(this.affiliation=!0,this.$http.get(r.a.marketFloor,{params:{marketCode:e.marketInfo.marketCode}}).then(function(t){0===t.code&&(e.floor=t.data.floors.split(","),e.area=t.data.marketPartitionNames)})),this.$http.get(r.a.boothName,{params:{marketCode:e.marketInfo.marketCode}}).then(function(t){0===t.code&&(e.typeList=t.data)})},methods:{marketChange:function(e){var t=this;t.ruleForm.floor="",t.ruleForm.boothTypeCode="",t.ruleForm.area="",t.ruleForm.boothCode="",t.marketList.forEach(function(a){a.marketCode==e&&(t.marketInfo.marketName=a.marketName,t.marketInfo.marketCode=e)}),this.$http.get(r.a.boothName,{params:{marketCode:t.marketInfo.marketCode}}).then(function(e){0===e.code&&(t.typeList=e.data)}),this.$http.get(r.a.marketFloor,{params:{marketCode:t.marketInfo.marketCode}}).then(function(e){0===e.code&&(t.floor=e.data.floors.split(","),t.area=e.data.marketPartitionNames)})},rightControl:function(e){return this.$store.getters.getPermission(e)},reset:function(){this.centerDialogVisible=!1,this.$refs.ruleForm.resetFields(),this.$refs.ruleForm.clearValidate()},getPageList:function(e){var t=this;this.pageParams.currentPage=e||1,this.$http.get(r.a.boothMaintains,{params:this.pageParams}).then(function(e){0===e.code&&(t.pageDefault.totalRecords=e.page.totalRecords,t.itemList=e.data)})},Dialog:function(e,t){var a=this;this.centerDialogVisible=!0,"add"==e?(this.title="摊位-添加",this.formType="add",setTimeout(function(){a.affiliation?a.ruleForm.marketCode=a.marketInfo.marketCode:a.marketInfo={},a.$refs.ruleForm.clearValidate()},100)):(this.title="摊位-修改",this.formType="edit",this.boothCode=t,this.$http.get(r.a.maintainsDetails,{params:{boothCode:t}}).then(function(e){0===e.code&&(a.ruleForm=e.data,a.ruleForm.units=e.data.units.code)}))},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(e){var o="";if("add"==a.formType)o="添加成功",t.$http({url:r.a.boothMaintains,method:"post",data:a.ruleForm,delayLoading:!1}).then(function(e){0===e.code&&(t.$message.success(o),a.centerDialogVisible=!1,a.getPageList())});else{o="修改成功",a.ruleForm.boothCode=a.boothCode;var l=a.boothCode;t.$http.put(r.a.boothMaintains+"/"+l,a.ruleForm).then(function(e){0===e.code&&(t.$message.success(o),a.centerDialogVisible=!1,a.getPageList(t.pageParams.currentPage))})}}})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"booth-maintenance"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.pageParams,"label-width":"102px","label-position":"right",inline:!0}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商场名称"}},[a("selectMarket",{attrs:{reqData:e.pageParams}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"摊位号"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pageParams.boothNumber,callback:function(t){e.$set(e.pageParams,"boothNumber","string"==typeof t?t.trim():t)},expression:"pageParams.boothNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.pageParams.boothTypeCode,callback:function(t){e.$set(e.pageParams,"boothTypeCode","string"==typeof t?t.trim():t)},expression:"pageParams.boothTypeCode"}},e._l(e.typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.boothTypeName,value:e.boothTypeCode}})}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"楼层经理"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pageParams.managerName,callback:function(t){e.$set(e.pageParams,"managerName","string"==typeof t?t.trim():t)},expression:"pageParams.managerName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"楼层"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.pageParams.floor,callback:function(t){e.$set(e.pageParams,"floor","string"==typeof t?t.trim():t)},expression:"pageParams.floor"}},e._l(e.floor,function(e,t){return a("el-option",{key:t,attrs:{label:e+"层",value:e}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.pageParams.boothStatus,callback:function(t){e.$set(e.pageParams,"boothStatus","string"==typeof t?t.trim():t)},expression:"pageParams.boothStatus"}},e._l(e.statusList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8,offset:16}},[a("div",{staticClass:"c-footer-btn"},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.getPageList(1)}}},[e._v("查询")])],1)])],1)],1),e._v(" "),a("div",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.rightControl("boothMain_3"),expression:"rightControl('boothMain_3')"}],staticClass:"btn-search btn-add",attrs:{type:"primary"},on:{click:function(t){e.Dialog("add")}}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",height:"500",stripe:""}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"boothNumber",label:"摊位号","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"booth-maintenance-hiddenText",attrs:{title:t.row.boothNumber}},[e._v(e._s(t.row.boothNumber))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"boothCode",label:"摊位编号","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"booth-maintenance-hiddenText",attrs:{title:t.row.boothCode}},[e._v(e._s(t.row.boothCode))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketName",label:"商场名称","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"boothTypeName",label:"类型","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"managerName",label:"楼层经理","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"floor",label:"楼层","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"area",label:"区域","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"boothStatus.desc",label:"状态","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"calculateArea",label:"计租面积","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.calculateArea.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"usableArea",label:"使用面积","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.usableArea.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"boothPrice",label:"摊位单价","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.boothPrice.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"units.desc",label:"单位","min-width":"140"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"notes",label:"备注","min-width":"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"booth-maintenance-hiddenText",attrs:{title:t.row.notes}},[e._v(e._s(t.row.notes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"190",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn-handle",attrs:{type:"primary",disabled:!e.rightControl("boothMain_2")},on:{click:function(a){e.Dialog("edit",t.row.boothCode)}}},[e._v("修改")])]}}])})],1)],1),e._v(" "),a("Pagenation",{attrs:{pageparams:e.pageDefault,itemList:e.itemList},on:{handlePage:e.getPageList}}),e._v(" "),a("el-dialog",{staticClass:"l-dialog",attrs:{title:e.title,visible:e.centerDialogVisible},on:{"update:visible":function(t){e.centerDialogVisible=t},close:e.reset}},[a("div",[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"80px"}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"摊位号",prop:"boothNumber"}},[a("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.boothNumber,callback:function(t){e.$set(e.ruleForm,"boothNumber","string"==typeof t?t.trim():t)},expression:"ruleForm.boothNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"商场",prop:"marketCode"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:e.affiliation},on:{change:e.marketChange},model:{value:e.ruleForm.marketCode,callback:function(t){e.$set(e.ruleForm,"marketCode","string"==typeof t?t.trim():t)},expression:"ruleForm.marketCode"}},e._l(e.marketList,function(e,t){return a("el-option",{key:t,attrs:{label:e.marketName,value:e.marketCode}})}))],1)],1)],1),e._v(" "),0==e.affiliation&&e.ruleForm.marketCode||1==e.affiliation?a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"楼层",prop:"floor"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.floor,callback:function(t){e.$set(e.ruleForm,"floor","string"==typeof t?t.trim():t)},expression:"ruleForm.floor"}},e._l(e.floor,function(e,t){return a("el-option",{key:t,attrs:{label:e+"层",value:e}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"摊位编号",prop:"boothCode"}},[a("el-input",{attrs:{clearable:"",disabled:""},model:{value:e.ruleForm.boothCode,callback:function(t){e.$set(e.ruleForm,"boothCode","string"==typeof t?t.trim():t)},expression:"ruleForm.boothCode"}})],1)],1)],1):e._e(),e._v(" "),0==e.affiliation&&e.ruleForm.marketCode||1==e.affiliation?a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"摊位类型",prop:"boothTypeCode"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.boothTypeCode,callback:function(t){e.$set(e.ruleForm,"boothTypeCode","string"==typeof t?t.trim():t)},expression:"ruleForm.boothTypeCode"}},e._l(e.typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.boothTypeName,value:e.boothTypeCode}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"区域",prop:"area"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.area,callback:function(t){e.$set(e.ruleForm,"area","string"==typeof t?t.trim():t)},expression:"ruleForm.area"}},e._l(e.area,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}))],1)],1)],1):e._e(),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"摊位单价",prop:"boothPrice"}},[a("el-input",{attrs:{clearable:"",maxlength:"8"},model:{value:e.ruleForm.boothPrice,callback:function(t){e.$set(e.ruleForm,"boothPrice","string"==typeof t?t.trim():t)},expression:"ruleForm.boothPrice"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"单位",prop:"units"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.units,callback:function(t){e.$set(e.ruleForm,"units","string"==typeof t?t.trim():t)},expression:"ruleForm.units"}},e._l(e.boothPriceList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"计租面积",prop:"calculateArea"}},[a("el-input",{staticClass:"input-m2",attrs:{clearable:"",maxlength:"8"},model:{value:e.ruleForm.calculateArea,callback:function(t){e.$set(e.ruleForm,"calculateArea","string"==typeof t?t.trim():t)},expression:"ruleForm.calculateArea"}}),e._v("  m²\n            ")],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"实际面积",prop:"usableArea"}},[a("el-input",{staticClass:"input-m2",attrs:{clearable:"",maxlength:"8"},model:{value:e.ruleForm.usableArea,callback:function(t){e.$set(e.ruleForm,"usableArea","string"==typeof t?t.trim():t)},expression:"ruleForm.usableArea"}}),e._v("  m²\n            ")],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{staticClass:"textarea",attrs:{label:"备注",prop:"notes"}},[a("el-input",{staticClass:"textareaInput",attrs:{type:"textarea",maxlength:"500"},model:{value:e.ruleForm.notes,callback:function(t){e.$set(e.ruleForm,"notes","string"==typeof t?t.trim():t)},expression:"ruleForm.notes"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-primary btn-save",attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")]),e._v(" "),a("el-button",{staticClass:"btn-primary btn-reset",attrs:{type:"primary"},on:{click:e.reset}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(e){a("X63B"),a("lPVx")},"data-v-1c9fb045",null);t.default=n.exports},X63B:function(e,t){},lPVx:function(e,t){}});
//# sourceMappingURL=63.1f9e95949de78645b6e4.js.map