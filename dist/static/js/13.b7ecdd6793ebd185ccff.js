webpackJsonp([13],{"32t9":function(e,t){},"F/mY":function(e,t){},LqJu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("bOdI"),r=a.n(i),n=a("zpED"),s={data:function(){return r()({rules:{},dialogFormVisible:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},pageparams:{},time:[],reqData:{creater:"",followEndDate:"",followStartDate:"",engineeringName:"",pageSize:20,currentPage:1},itemList:[],engNameList:[],add_data:{completePercent:0,description:"",engineeringName:"",followDate:""}},"rules",{engineeringName:[{required:!0,message:"请选择工程名称",trigger:"blur"}],description:[{required:!1,trigger:"blur"},{max:100,message:"工程进度描述不能多于100个字符",trigger:"blur"}],completePercent:[{required:!0,message:"请输入工程进度",trigger:"blur"},{pattern:/(^[1-9][0-9]$|^[0-9]$|^100$)/,message:"请输入正确的工程进度",trigger:"blur"}],followDate:[{required:!0,message:"请选择跟进日期",trigger:"blur"}]})},components:{pagenation:a("hm3b").a},name:"engineeringLogs",methods:{percent_valid:function(){this.add_data.completePercent&&(isNaN(this.add_data.completePercent)?this.add_data.completePercent="0":this.add_data.completePercent=parseInt(this.add_data.completePercent))},indexMethod:function(e){return 20*(this.reqData.currentPage-1)+e+1},getEngName:function(){var e=this;this.$http.get(n.a.engName,{params:this.reqData}).then(function(t){t&&0==t.code&&t.data?e.engNameList=t.data:e.engNameList=[]})},getListData:function(){var e=this;this.$http.get(n.a.logList,{params:this.reqData}).then(function(t){t&&0==t.code&&t.data?(e.itemList=t.data,e.pageparams=t.page):e.itemList=[]})},search:function(){this.reqData.currentPage=1,this.reqData.followStartDate=this.time?this.time[0]:"",this.reqData.followEndDate=this.time?this.time[1]:"",this.getListData()},handlePage:function(e){this.reqData.currentPage=e,this.getListData()},add:function(){var e=this;this.dialogFormVisible=!0,setTimeout(function(){e.$refs.add_form.resetFields()},50)},save:function(){var e=this;this.$refs.add_form.validate(function(t){t&&e.$http.post(n.a.addLog,e.add_data).then(function(t){t&&0==t.code&&(e.$message({message:"保存成功",type:"success"}),e.dialogFormVisible=!1,e.getListData())})})},cancel:function(){this.dialogFormVisible=!1}},created:function(){this.getListData(),this.getEngName()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contract-receipts g-engineer-main"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"工程名称",prop:"engineeringName","min-width":"120"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.engineeringName,callback:function(t){e.$set(e.reqData,"engineeringName","string"==typeof t?t.trim():t)},expression:"reqData.engineeringName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"添加人",prop:"creater"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.creater,callback:function(t){e.$set(e.reqData,"creater","string"==typeof t?t.trim():t)},expression:"reqData.creater"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"跟进起止时间",prop:"time"}},[a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"年/月/日","default-time":["00:00:00","23:59:59"],"end-placeholder":"年/月/日",align:"right","value-format":"yyyy-MM-dd"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"c-footer-btn"},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)])],1)],1),e._v(" "),a("div",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getPermission("engineeringLog_2"),expression:"$store.getters.getPermission('engineeringLog_2')"}],staticClass:"btn-search btn-add",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",stripe:"",height:"500"}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"engineeringName",label:"工程名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"market",label:"商场名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"followDate",label:"跟进日期"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"completePercent",label:"完成百分比"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"description",label:"工程进度描述"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime",label:"登记日期"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"creater",label:"登记人"}})],1)],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("pagenation",{attrs:{pageparams:e.pageparams,itemList:e.itemList},on:{handlePage:e.handlePage}})],1),e._v(" "),a("el-dialog",{staticClass:"m-dialog log_dialog",attrs:{title:"工程日志-添加",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"add_form",staticClass:"c-search-form",attrs:{model:e.add_data,rules:e.rules,"label-width":"110px",inline:!0,"label-position":"right"}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"工程名称",prop:"engineeringName"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.add_data.engineeringName,callback:function(t){e.$set(e.add_data,"engineeringName",t)},expression:"add_data.engineeringName"}},e._l(e.engNameList,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}))],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"跟进日期",prop:"followDate"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.add_data.followDate,callback:function(t){e.$set(e.add_data,"followDate",t)},expression:"add_data.followDate"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"完成百分比",prop:"completePercent"}},[a("el-input",{attrs:{clearable:""},on:{blur:e.percent_valid},model:{value:e.add_data.completePercent,callback:function(t){e.$set(e.add_data,"completePercent","string"==typeof t?t.trim():t)},expression:"add_data.completePercent"}})],1),e._v(" "),a("span",{staticClass:"u-special-unit"},[e._v("%")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"u-special-textarea",attrs:{label:"工程进度描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.add_data.description,callback:function(t){e.$set(e.add_data,"description","string"==typeof t?t.trim():t)},expression:"add_data.description"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{staticClass:"btn-reset",attrs:{type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(s,l,!1,function(e){a("32t9"),a("F/mY")},"data-v-5e2dec0c",null);t.default=o.exports},zpED:function(e,t,a){"use strict";var i=a("Dd8w"),r=a.n(i)()({},{maintainList:"/business/engineering/maintain",addmaintain:"/business/engineering/maintain",logList:"/business/engineering/log",addLog:"/business/engineering/log",engName:"/business/engineering/maintain/engname"});t.a=r}});
//# sourceMappingURL=13.b7ecdd6793ebd185ccff.js.map