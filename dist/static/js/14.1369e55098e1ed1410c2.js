webpackJsonp([14],{"1Fc1":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),n=a.n(i),r=a("zpED"),s={data:function(){return{dialogFormVisible:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},pageparams:{},time:[],reqData:{charge:"",startDate:"",endDate:"",engineeringName:"",pageSize:20,currentPage:1},itemList:[],dialog_title:"工程-添加",add_data:{decoTime:[],planTime:[],engineerTime:[],address:"",budget:"0.00",charge:"",chargePhone:"",company:"",contact:"",contactPhone:"",decoEndDate:"",decoStartDate:"",endDate:"",engineeringName:"",planEndDate:"",planStartDate:"",startDate:""},rules:{engineeringName:[{required:!0,message:"请输入工程名称",trigger:"blur"},{max:50,message:"工程项目不能多于50个字符",trigger:"blur"}],budget:[{required:!0,message:"请输入工程预算",trigger:"blur"},{pattern:/^\d+(\.\d{1,2})?$/,message:"请输入正确的金额(两位小数)",trigger:"blur"}],charge:[{required:!0,message:"请输入工程负责人",trigger:"blur"},{max:20,message:"工程负责人不能多于20个字符",trigger:"blur"}],chargePhone:[{required:!0,message:"请输入负责人电话",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],engineerTime:[{required:!0,message:"请选择工程时间",trigger:"blur"}],planTime:[{required:!0,message:"请选择规划时间",trigger:"blur"}],decoTime:[{required:!0,message:"请选择装修时间",trigger:"blur"}],address:[{required:!1,trigger:"blur"},{max:50,message:"公司地址不能多于30个字符",trigger:"blur"}],company:[{required:!1,trigger:"blur"},{max:50,message:"公司名称不能多于30个字符",trigger:"blur"}],contactPhone:[{required:!1,trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],contact:[{required:!1,trigger:"blur"},{max:20,message:"公司联系人不能多于30个字符",trigger:"blur"}]},editEngineeringId:""}},components:{pagenation:a("hm3b").a},name:"engineeringMain",methods:{indexMethod:function(e){return 20*(this.reqData.currentPage-1)+e+1},getListData:function(){var e=this;this.$http.get(r.a.maintainList,{params:this.reqData}).then(function(t){t&&0==t.code&&t.data?(e.itemList=t.data,e.pageparams=t.page):e.itemList=[]})},search:function(){this.reqData.currentPage=1,this.reqData.startDate=this.time?this.time[0]:"",this.reqData.endDate=this.time?this.time[1]:"",this.getListData()},handlePage:function(e){this.reqData.currentPage=e,this.getListData()},delete_eng:function(e,t){var a=this;this.$confirm("是否删除该工程?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=r.a.addmaintain+"/"+t.engineeringId;a.$http.delete(e).then(function(e){e&&0==e.code&&(a.getListData(),a.$message({message:"删除成功",type:"success"}))})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},add:function(){this.dialog_title="工程-添加",this.dialogFormVisible=!0},clean_data:function(){n()(this.add_data,this.$options.data().add_data)},edit_eng:function(e,t){var a=this;this.dialogFormVisible=!0,this.dialog_title="工程-修改",this.editEngineeringId=t.engineeringId;var i=r.a.addmaintain+"/"+this.editEngineeringId;this.$http.get(i).then(function(e){e&&0==e.code&&e.data&&(e.data.engineerTime=[],e.data.planTime=[],e.data.decoTime=[],e.data.engineerTime.push(e.data.startDate),e.data.engineerTime.push(e.data.endDate),e.data.planTime.push(e.data.planStartDate),e.data.planTime.push(e.data.planEndDate),e.data.decoTime.push(e.data.decoStartDate),e.data.decoTime.push(e.data.decoEndDate),n()(a.add_data,e.data))})},save_data:function(){var e=this;this.$refs.add_form.validate(function(t){if(!t)return!1;var a=n()({},e.add_data);a.budget=Number(a.budget).toFixed(2),a.decoStartDate=a.decoTime?a.decoTime[0]:"",a.decoEndDate=a.decoTime?a.decoTime[1]:"",a.planStartDate=a.planTime?a.planTime[0]:"",a.planEndDate=a.planTime?a.planTime[1]:"",a.startDate=a.engineerTime?a.engineerTime[0]:"",a.endDate=a.engineerTime?a.engineerTime[1]:"",delete a.decoTime,delete a.planTime,delete a.engineerTime,"工程-添加"==e.dialog_title?e.$http.post(r.a.addmaintain,a).then(function(t){t&&0==t.code&&(e.$message({message:"保存成功",type:"success"}),e.dialogFormVisible=!1,e.getListData(),e.$refs.add_form.resetFields())}):(a.engineeringId=e.editEngineeringId,e.$http.put(r.a.addmaintain,a).then(function(t){t&&0==t.code&&(e.$message({message:"保存成功",type:"success"}),e.dialogFormVisible=!1,e.getListData(),e.$refs.add_form.resetFields())}))})},cancel:function(){this.dialogFormVisible=!1}},created:function(){this.getListData()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contract-receipts"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"工程名称",prop:"engineeringName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.engineeringName,callback:function(t){e.$set(e.reqData,"engineeringName","string"==typeof t?t.trim():t)},expression:"reqData.engineeringName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"负责人",prop:"charge"}},[a("el-input",{attrs:{clearable:""},model:{value:e.reqData.charge,callback:function(t){e.$set(e.reqData,"charge","string"==typeof t?t.trim():t)},expression:"reqData.charge"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"search_time",attrs:{label:"工程起止日期",prop:"time"}},[a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"年/月/日","default-time":["00:00:00","23:59:59"],"end-placeholder":"年/月/日",align:"right","value-format":"yyyy-MM-dd"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"c-footer-btn"},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],1)])],1)],1),e._v(" "),a("div",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getPermission("engineeringMain_2"),expression:"$store.getters.getPermission('engineeringMain_2')"}],staticClass:"btn-search btn-add",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.itemList,align:"center",stripe:"",height:"500"}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"engineeringName",label:"工程名称","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"market",label:"商场名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"工程起止日期","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.startDate)+"至"+e._s(t.row.endDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"规划设计日期","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.planStartDate)+"至"+e._s(t.row.planEndDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"supplier",label:"装修时间","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.decoStartDate)+"至"+e._s(t.row.decoEndDate)+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"budget",label:"工程预算"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"charge",label:"工程负责人","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"chargePhone",label:"负责人电话","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime",label:"登记日期","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getPermission("engineeringMain_3"),expression:"$store.getters.getPermission('engineeringMain_3')"}],staticClass:"btn-handle",attrs:{type:"primary"},on:{click:function(a){e.edit_eng(t.$index,t.row)}}},[e._v("\n            修改\n          ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getPermission("engineeringMain_4"),expression:"$store.getters.getPermission('engineeringMain_4')"}],staticClass:"btn-handle",attrs:{type:"primary"},on:{click:function(a){e.delete_eng(t.$index,t.row)}}},[e._v("\n            删除\n          ")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("pagenation",{attrs:{pageparams:e.pageparams,itemList:e.itemList},on:{handlePage:e.handlePage}})],1),e._v(" "),a("el-dialog",{staticClass:"l-dialog engineer_dialog",attrs:{title:e.dialog_title,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clean_data}},[a("el-form",{ref:"add_form",staticClass:"c-search-form",attrs:{model:e.add_data,rules:e.rules,"label-width":"120px",inline:!0,"label-position":"right"}},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"工程名称",prop:"engineeringName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.engineeringName,callback:function(t){e.$set(e.add_data,"engineeringName","string"==typeof t?t.trim():t)},expression:"add_data.engineeringName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12,xs:24}},[a("el-form-item",{attrs:{label:"工程预算",prop:"budget"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.budget,callback:function(t){e.$set(e.add_data,"budget","string"==typeof t?t.trim():t)},expression:"add_data.budget"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"工程负责人电话",prop:"chargePhone"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.chargePhone,callback:function(t){e.$set(e.add_data,"chargePhone","string"==typeof t?t.trim():t)},expression:"add_data.chargePhone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"工程负责人",prop:"charge"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.charge,callback:function(t){e.$set(e.add_data,"charge","string"==typeof t?t.trim():t)},expression:"add_data.charge"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"工程时间",prop:"engineerTime"}},[a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束日期",align:"right","value-format":"yyyy-MM-dd"},model:{value:e.add_data.engineerTime,callback:function(t){e.$set(e.add_data,"engineerTime",t)},expression:"add_data.engineerTime"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"规划时间",prop:"planTime"}},[a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束日期",align:"right","value-format":"yyyy-MM-dd"},model:{value:e.add_data.planTime,callback:function(t){e.$set(e.add_data,"planTime",t)},expression:"add_data.planTime"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"装修时间",prop:"decoTime"}},[a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束日期",align:"right","value-format":"yyyy-MM-dd"},model:{value:e.add_data.decoTime,callback:function(t){e.$set(e.add_data,"decoTime",t)},expression:"add_data.decoTime"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"company_message"},[a("p",[e._v("装修公司信息")])]),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"公司名称",prop:"company"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.company,callback:function(t){e.$set(e.add_data,"company","string"==typeof t?t.trim():t)},expression:"add_data.company"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系人",prop:"contact"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.contact,callback:function(t){e.$set(e.add_data,"contact","string"==typeof t?t.trim():t)},expression:"add_data.contact"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系方式(手机号)",prop:"contactPhone"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.contactPhone,callback:function(t){e.$set(e.add_data,"contactPhone","string"==typeof t?t.trim():t)},expression:"add_data.contactPhone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{clearable:""},model:{value:e.add_data.address,callback:function(t){e.$set(e.add_data,"address","string"==typeof t?t.trim():t)},expression:"add_data.address"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:e.save_data}},[e._v("保存")]),e._v(" "),a("el-button",{staticClass:"btn-reset",attrs:{type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(s,l,!1,function(e){a("hNnf"),a("okzc")},"data-v-0b08964b",null);t.default=d.exports},hNnf:function(e,t){},okzc:function(e,t){},zpED:function(e,t,a){"use strict";var i=a("Dd8w"),n=a.n(i)()({},{maintainList:"/business/engineering/maintain",addmaintain:"/business/engineering/maintain",logList:"/business/engineering/log",addLog:"/business/engineering/log",engName:"/business/engineering/maintain/engname"});t.a=n}});
//# sourceMappingURL=14.1369e55098e1ed1410c2.js.map