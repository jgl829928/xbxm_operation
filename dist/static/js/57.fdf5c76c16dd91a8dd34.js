webpackJsonp([57],{"5Qbp":function(t,e){},BqM4:function(t,e){},qnp5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("4YfN"),i=a.n(n),l=a("eMGh"),r=a("2A+d"),o=a("FTcF"),s=a("TIfe"),c=a("hm3b"),m={name:"maintenance",data:function(){return{dialogFormVisible1:!1,dialogFormVisible2:!1,categotyListFir:[],reqData:{marketCode:"",rankId:""},pageparams:{currentPage:""},itemList:[],fileList1:[],fileList2:[],title:""}},components:{selectMarket:o.a,pagenation:c.a},created:function(){this.handleCategory("-1","categotyListFir"),this.getData(1)},methods:{rightControl:function(t){return this.$store.getters.getPermission(t)},download_file:function(t,e){var a=this;this.$http({method:"get",url:"/business/download",params:{fileUrl:t},showLoading:!1,responseType:"arraybuffer"}).then(function(t){a.download(t.data,e)})},download:function(t,e){if(t){var a=new Blob([t]);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,e);else{var n=window.URL.createObjectURL(new Blob([t])),i=document.createElement("a");i.style.display="none",i.href=n,i.setAttribute("download",e),document.body.appendChild(i),i.click()}}},search:function(){this.getData()},checkConstrck1:function(t,e){this.dialogFormVisible1=!0,t.imgContractUrl?this.fileList1=t.imgContractUrl:this.fileList1=[]},checkConstrck2:function(t,e){this.dialogFormVisible2=!0,t.imgAccessoryUrl?this.fileList2=t.imgAccessoryUrl:this.fileList2=[]},getData:function(t){t=t||"";var e=i()({},this.reqData,{currentPage:t});Object(s.b)(t,e,r.a.maintenance,this)},handleCategory:function(t,e){var a=this;this.$http({url:l.b.deviceCategory,method:"get",params:{parentId:t}}).then(function(t){t&&0==t.code&&(a[e]=t.data)})},handlePage:function(t){this.getData(t)},deleteData:function(t){var e=this;this.$confirm("此操作将永久删除该条, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.delete(r.a.maintenance+"/"+t,{params:{maintenance:t}}).then(function(t){t&&0==t.code&&(e.$message({type:"success",message:t.msg}),e.getData(e.pageparams.currentPage))})}).catch(function(){})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"g-maintenance-management"},[a("el-form",{ref:"reqData",staticClass:"c-search-form",attrs:{model:t.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"商场",prop:"marketCode"}},[a("select-market",{attrs:{reqData:t.reqData}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"一级分类",prop:"rankId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.reqData.rankId,callback:function(e){t.$set(t.reqData,"rankId",e)},expression:"reqData.rankId"}},t._l(t.categotyListFir,function(t,e){return a("el-option",{key:e,attrs:{label:t.rankName,value:t.rankId}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("查询")])],1)],1),t._v(" "),a("el-row",[a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.rightControl("maintenance_add"),expression:"rightControl('maintenance_add')"}],attrs:{span:8}},[a("router-link",{attrs:{to:{name:"addMainRecord"}}},[a("el-button",{staticClass:"btn-search btn-add",attrs:{type:"primary"}},[t._v("\n              添加维保记录\n              ")])],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"c-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.itemList,align:"center",height:"500",stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"maintenanceId","min-width":"160",label:"维保序号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"marketName",label:"所属商场"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"rankName",label:"设备类型"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"equipmentName",label:"设备名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"equipmentCode","min-width":"160",label:"设备编号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"maintenanceCompany",label:"维保公司"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"maintenancePerson",label:"维保人"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"maintenanceCost",label:"维保金额"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"beginTime","min-width":"165",label:"维保开始时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"endTime","min-width":"165",label:"维保结束时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"",label:"维保合同"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{directives:[{name:"show",rawName:"v-show",value:t.rightControl("maintenance_contractInfo"),expression:"rightControl('maintenance_contractInfo')"}],staticClass:"u-check",on:{click:function(a){t.checkConstrck1(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"",label:"维保附件"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{directives:[{name:"show",rawName:"v-show",value:t.rightControl("maintenance_accessoryInfo"),expression:"rightControl('maintenance_accessoryInfo')"}],staticClass:"u-check",on:{click:function(a){t.checkConstrck2(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createName",label:"登记人"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"createTime","min-width":"165",label:"登记时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right","min-width":"190"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{directives:[{name:"show",rawName:"v-show",value:t.rightControl("maintenance_edit"),expression:"rightControl('maintenance_edit')"}],attrs:{to:{name:"editMainRecord",params:{maintenanceId:e.row.maintenanceId}}}},[a("el-button",{staticClass:"btn-handle",attrs:{type:"primary"}},[t._v("\n              修改\n          ")])],1),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.rightControl("maintenance_delete"),expression:"rightControl('maintenance_delete')"}],staticClass:"btn-handle btn-add",attrs:{type:"primary"},on:{click:function(a){t.deleteData(e.row.maintenanceId)}}},[t._v("\n              删除\n          ")])]}}])})],1)],1),t._v(" "),a("pagenation",{attrs:{pageparams:t.pageparams,itemList:t.itemList},on:{handlePage:t.handlePage}}),t._v(" "),a("el-dialog",{staticClass:"s-dialog",attrs:{title:"维保合同-查看",visible:t.dialogFormVisible1,center:""},on:{"update:visible":function(e){t.dialogFormVisible1=e}}},[a("div",[t._l(t.fileList1,function(e,n){return a("el-row",{key:n},[a("el-col",{staticClass:"u-left",attrs:{span:19,xs:24}},[a("span",[t._v(t._s(e.name))]),t._v(" "),0==t.fileList1.length?a("span",[t._v("（无）")]):t._e()]),t._v(" "),a("el-col",{staticClass:"u-center",attrs:{span:5,xs:24}},[a("a",{on:{click:function(a){t.download_file(e.url,e.name)}}},[t._v("下载")])])],1)}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-80",on:{click:function(e){t.dialogFormVisible1=!1}}},[t._v("关 闭")])],1)],2)]),t._v(" "),a("el-dialog",{staticClass:"s-dialog",attrs:{title:"维保附件-查看",visible:t.dialogFormVisible2,center:""},on:{"update:visible":function(e){t.dialogFormVisible2=e}}},[a("div",[t._l(t.fileList2,function(e,n){return a("el-row",{key:n},[a("el-col",{staticClass:"u-left",attrs:{span:19,xs:24}},[a("span",[t._v(t._s(e.name))]),t._v(" "),0==t.fileList2.length?a("span",[t._v("（无）")]):t._e()]),t._v(" "),a("el-col",{staticClass:"u-center",attrs:{span:5,xs:24}},[a("a",{on:{click:function(a){t.download_file(e.url,e.name)}}},[t._v("下载")])])],1)}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-80",on:{click:function(e){t.dialogFormVisible2=!1}}},[t._v("关 闭")])],1)],2)])],1)},staticRenderFns:[]};var u=a("vSla")(m,d,!1,function(t){a("5Qbp"),a("BqM4")},"data-v-2c4b2222",null);e.default=u.exports}});
//# sourceMappingURL=57.fdf5c76c16dd91a8dd34.js.map